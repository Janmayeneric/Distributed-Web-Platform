<!DOCTYPE html>
<html lang="en">
	<head>
		<title>CS3099</title>
        <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1, user-scalable=0"/>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
        <script src="https://kit.fontawesome.com/a8d20fadb9.js" crossorigin="anonymous"></script> <!-- For embedded icons -->
        <!-- Toastr JS CDNs-->
        <link rel="icon" type="image/png" href="/images/favicon.ico"/>
        <link type="text/css" rel="stylesheet" href="styles/homepage.css">
        <link type="text/css" rel="stylesheet" href="styles/comments.css">
        <link type="text/css" rel="stylesheet" href="styles/communities.css">
        <link type="text/css" rel="stylesheet" href="styles/followers.css">
        <link type="text/css" rel="stylesheet" href="styles/post.css">
        <link type="text/css" rel="stylesheet" href="styles/search.css">
        <link type="text/css" rel="stylesheet" href="styles/notifications.css">
	</head>
    <body>
        <!-- Cookie warning : https://getbootstrap.com/docs/4.0/components/alerts/ -->
        <div class="overlay-style alert alert-info alert-dismissible fade show" role="alert">
            <p>
                By using our website, you have agreed to allow us to temporarily store
                session state, like tokens, on your system. All handling of data on 
                this site complies with GDPR regulations described 
                <a href='https://ico.org.uk/for-organisations/guide-to-data-protection/guide-to-the-general-data-protection-regulation-gdpr/principles/'>here.</a>
            </p>
            <button type="button" class="btn btn-primary" data-dismiss="alert" aria-label="Ok">
                <span aria-hidden="true">Ok</span>
            </button>
        </div>
        <div class="container-fluid"> <!-- Banner -->
            <div class="row" id="header_id">
                <div class="col-md-4 float-left header">
                    <h3 class="text-break">CS3099 Project<small class="text-muted text-break"> Group 10B</small></h3>
                </div>
                <div class="col-md-5 header d-flex justify-content-center">
                    <div class="row">
                        <div class="col-md-12 mt-2">
                            <input class="w-100 form-control" type="search" placeholder="Please enter search criteria" id="searchbar_id" style="display: none;" autocomplete="off">
                        </div>
                        <div class="col-md-12 mt-2" id="radio_btns_div_id" style="display: none;"> <!-- Radio buttons for selecting search criteria-->
                            <input type="radio" name= "search_selector" value="Name" id="search_name_selector_id">
                            <label class="mr-2 text-break" for="search_selector">
                                Name
                            </label>
                            <input type="radio" name="search_selector"  value="Genre" id="search_genre_selector_id">
                            <label class="mr-2 text-break" for="search_selector">
                                Genre
                            </label>
                            <input type="radio" name="search_selector"  value="Topic" id="search_topic_selector_id">
                            <label class="mr-2 text-break" for="search_selector">
                                Topic
                            </label>
                            <input type="radio" name="search_selector"  value="User" id="search_user_selector_id">
                            <label class="mr-2 text-break" for="search_selector">
                                User
                            </label>
                            <label id="search_error_message_id" class="search-error" style="color: red;">Defaulting to search by genre</label>
                        </div>
                    </div>
                </div>
                <div class="col-md-1">
                </div>
                <div class="col-md-2 col-xl-2">
                    <div id="knownUser_id" class="known-user-id row" style="display: none;">
                        <div class="col-md-6 col-xl-6 dropdown mt-2 float-left">
                            <button class="btn" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                               <i class="fas fa-bell fa-2x" alt="Notifications"></i>
                            </button>
                            <div class="dropdown-menu dropdown-menu-right pb-0" aria-labelledby="dropdownMenuButtonNotifications" id="notifications_area_id">
                                <div id="no_notifications_message_id" class="dropdown-item text-break notification"><h5>You have no notifications</h5></div>
                            </div>
                        </div>
                        <div class="col-md-6 col-xl-6 dropdown mt-1 float-right">
                            <button class="btn profile-dropdown-btn dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <img src="images/profile.png" class="img-thumbnail profile-image" id="profile_image_id" alt="User logo">
                            </button>
                            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton">
                              <a class="dropdown-item text-break" href="#" data-toggle="modal" data-target="#profile_modal_id">Profile</a>
                              <a class="dropdown-item text-break" href="#" data-toggle="modal" data-target="#change_username_modal_id">Change Username</a>
                              <a class="dropdown-item text-break" href="#" data-toggle="modal" data-target="#change_password_modal_id">Change Password</a>
                              <a class="dropdown-item text-break" href="#" id="logout_option">Logout</a>
                              <a class="dropdown-item text-break" href="#" onclick="deleteUserAccount()" data-target="#delete_account_modal_id">Delete Account</a>
                            </div>
                        </div>
                    </div>
                    <div id="unknown_user_options_id" style="display: none;">
                        <a href="signin.html" class="d-flex justify-content-center btn btn-primary sign-in mt-3 text-break" id="signinbtn_id">Login</a>
                        <a href="signup.html" class="d-flex justify-content-center btn btn-primary sign-up mb-3 text-break" id="signupbtn_id">Register</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid h-100"> <!--Posts and sidebars-->
            <div class="row"> 
                <div class="col-md-2 col-xl-2" id="navigation_id"> <!-- Left side bar -->
                    <div class="row">
                        <nav class="navbar">
                            <ul class="navbar-nav mr-auto">
                                <li class="nav-item active">
                                  <a class="nav-link text-break" href="/">Home</a>
                                </li>
                                <li class="nav-item text-break">
                                    <a class="nav-link" href="/about.html">About</a>
                                  </li>
                              </ul>
                        </nav>
                    </div>
                    <div class="row community-viewer" style="display: none;" >
                        <div class="col-md-12">
                            <p><u>Community Viewer</u></p>
                            <input type="text" class="form-control mb-2" id="community_viewer_id" placeholder="Community Name" aria-label="Community Name">
                            <button id="community_viewer_btn_id" class="btn btn-outline-info text-break" onclick="showSpecificCommunityPosts(this)" data-clicked="false">See just community posts</button>
                        </div>
                    </div>
                    <div class="row following-viewer mt-2" style="display: none;" >
                        <div class="col-md-12">
                            <p><u>Follower Viewer</u></p>
                            <button id="following_viewer_btn_id" class="btn btn-outline-info text-break" onclick="showFollowingPosts(this)" data-clicked="false">See just follower posts</button>
                        </div>
                    </div>
                    <div class="row pt-5 popular-communities" style="display: none;">
                        <div class="col-md-12 d-flex justify-content-center">
                            <button class="btn btn-secondary d-flex justify-content-center text-break" data-toggle="collapse" data-target="#popular_community_list">Popular Communities</button>
                        </div>
                    </div>
                    <div class="row pt-2 popular-communities collapse" style="display: none;">
                        <div class="col-md-12">
                            <ul class="list-group collapse" id="popular_community_list">
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-1 col-xl-2"> <!--Columns for padding-->
                </div>
                <div class="col-md-6 col-xl-4" id="content_column_id"> <!-- Posts area --> 
                    <div class="row d-flex justify-content-center pt-3">
                        <div class="btn btn-secondary rounded-pill refresh-button-container" 
                            id="refresh_container_id" onclick="handleRefresh()">
                            <p class="refresh-button text-break">Refresh <i class="fa fa-refresh fa-lg" aria-hidden="true"></i></p>
                        </div>
                    </div>
                    <div class="row no-posts-message justify-content-center text-break" style="display: none;" id="no_posts_message_id">
                        <h3>You have no new posts</h3>
                    </div>
                    <div class="row justify-content-center pt-5 unknown-user-img mt-5" style="display: none;" id="unknown_user_img_id">
                        <div class="col-md-12">
                            <div class="row justify-content-center">
                                <div class="col-md-12 d-flex justify-content-center">
                                    <i class="fas fa-users-slash fa-7x"></i>
                                </div>
                            </div>
                            <div class="row justify-content-center pt-5">
                                <div class="col-md-12 justify-content-center">
                                    <noscript>Your browser does not support JavaScript, please turn on to use this site</noscript>
                                    <h3 class="text-break">Please login or register to see posts.</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                    <noscript>Your browser does not support JavaScript, please turn on to use this site</noscript>
                    <div class="col-md-12" id="post_container_id"></div>
                    <div class="col-md-12" id="community_viewer_container_id"></div>
                    <div class="col-md-12" id="followers_viewer_container_id"></div>
                    <div class="row d-flex justify-content-center copyright text-break">
                        <p>&copy; 2020-2021 Group 10B.</p>
                    </div>
                </div>
                <!-- Search results -->
                <div class="col-md-6 col-xl-4" id="search_results_id" style="display: none;">
                    <div class="d-flex justify-content-center mt-4" style="display: none;">
                        <h4 id="no_matching_results">No results</h4>
                    </div>
                    <div id="search_results_container_id"></div>
                    <div id="search_username_container_id"></div>
                    <div class="row d-flex justify-content-center copyright text-break">
                        <p>&copy; 2020-2021 Group 10B.</p>
                    </div>
                </div>
                <div class="col-md-1 col-xl-2">	<!-- Creates offset between post and owned communities bar -->
                </div>
                <div class="col-md-2 col-xl-2" style="background-color:rgb(230, 230, 230);"> <!-- Right side bar -->
                    <div class="row">
                        <div class="col-md-12 d-flex justify-content-center pb-4 pt-4">
                            <button class="btn btn-success post-btn text-break" id="post_button_id" style="width: 160px;" data-toggle="modal" data-target="#post_modal_id" onclick="preparePostModal()">
                                Post
                            </button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 d-flex justify-content-center pb-4">
                            <button class="btn btn-success create-community-btn text-break" id="comm_create_btn_id" style="width: 160px;" data-toggle="modal" data-target="#create_community_modal_id">
                                Create community</button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 d-flex justify-content-center pb-4">
                            <button class="btn btn-success delete-community-btn text-break" id="comm_delete_button" style="width: 160px;" data-toggle="modal" data-target="#delete_community_modal_id" onclick="prepareDeleteModal();">
                                Delete community</button>
                        </div>
                    </div>
                    <div class= "row random-act-of-kindness mt-4">
                        <div class="col-md-12 d-flex justify-content-center">
                            <button class="btn btn-outline-success text-break" id="random_act_of_kindness_btn_id" onclick="randomActOfKindness()"> Commit Random Act of Kindness </button>
                        </div>
                    </div>
                    <div class="row pt-5 all-communities" style="display: none;">
                        <div class="col-md-12">
                            <p class="d-flex justify-content-center text-break">Your Communities:</p>
                        </div>
                    </div>
                    <div class="row pt-2  all-communities" style="display: none;">
                        <div class="col-md-12">
                            <ul class="list-group d-flex justify-content-center" id="all_community_list">

                            </ul>
                        </div>
                    </div>
                    <div class="row pt-5 owned-communities" style="display: none;">
                        <div class="col-md-12">
                            <p class="d-flex justify-content-center text-break">Owned Communities:</p>
                        </div>
                    </div>
                    <div class="row pt-2 owned-communities" style="display: none;">
                        <div class="col-md-12">
                            <ul class="list-group d-flex justify-content-center" id="community_list">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Load in modals -->
        <div id="post_modal_container"></div>
        <div id="create_communities_modal_container"></div>
        <div id="delete_communities_modal_container"></div>
        <div id="comments_modal_container"></div>
        <div id="change_username_modal_container"></div>
        <div id="change_password_modal_container"></div>
        <div id="profile_modal_container"></div>
    </body>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> 
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script> <!-- Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script> <!-- Handles alert messages -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js" type="text/javascript"></script> <!-- For easy access to cookies -->
    <link href= "https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.css" rel="stylesheet"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <!-- Our JQuery and Javascript-->
    <script src="javascript/page_setup.js"></script>
    <script src="javascript/common.js"></script>
    <script src="javascript/posts.js"></script>
    <script src="javascript/comments.js"></script>
    <script src="javascript/communities.js"></script>
    <script src="javascript/followers.js"></script>
    <script src="javascript/search.js"></script>
    <script src="javascript/notifications.js"></script>
    <script>
        "use strict";
        //Global variables
        let numberOfPosts = 0;
        let numberOfComments = 0;
        let postErrorID = -1;
        let commentErrorID = -1;
        let rootCommentParent = 0;
        let rootPath = "/"; 
        let username; //default username, should be extracted from cookie.

        // Starts the page
        $(document).ready(function(){
            loadModals();
        });
        /*
        * Summary of components that use data-attributes.
        *
        * Post
        * -> post_content_id, called 'obj', stores the dataTransferObject.
        * -> numberOfComments, stores the number of comments for that post.
        * -> uniquePOSTid, the unique identifier for a post.
        * -> comments, stores all of its comments.
        *
        * fa-comments
        * -> clicked, used for toggling between creation and destruction.
        *
        * Reply
        * -> clicked, used for toggling between creation and destruction of comment box.
        *
        * Comment
        * -> Unique comment id used to identify that comment in the post - generated by server; may not be unique from comments in other posts.
        *
        * Modals
        * -> postID, used to identify which post created the modal.
        *
        */
    </script>
</html>
